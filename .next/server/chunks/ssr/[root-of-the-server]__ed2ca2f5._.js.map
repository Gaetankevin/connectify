{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../app/ui/login-form.tsx","../../../../app/actions/data%3A040c2c%20%3Ctext/javascript%3E"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useActionState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { login } from \"../actions/auth\";\nimport { LoginFormSchema } from \"../lib/definitions\";\n\ntype StepKey = \"username_email\" | \"password\";\n\nconst steps: {\n  key: StepKey;\n  label: string;\n  type?: string;\n  placeholder?: string;\n}[] = [\n  {\n    key: \"username_email\",\n    label: \"Nom d'utilisateur ou email\",\n    placeholder: \"Nom d'utilisateur ou email\",\n  },\n  {\n    key: \"password\",\n    label: \"Mot de passe\",\n    type: \"password\",\n    placeholder: \"Votre mot de passe\",\n  },\n];\n\nexport default function LoginForm() {\n  const [state, action, pending] = useActionState(login, undefined);\n  const router = useRouter();\n\n  useEffect(() => {\n    if (state && (state as any).redirectTo) {\n      const target = (state as any).redirectTo as string;\n      if (target) router.push(target);\n    }\n  }, [state, router]);\n\n  const [stepIndex, setStepIndex] = useState(0);\n  const [values, setValues] = useState<Record<StepKey, string>>({\n    username_email: \"\",\n    password: \"\",\n  });\n  const [error, setError] = useState<string | null>(null);\n\n  const current = steps[stepIndex];\n\n  const getFieldSchema = (key: StepKey) => {\n    // access the zod shape for per-field validation\n    // @ts-ignore\n    return (LoginFormSchema as any).shape[key];\n  };\n\n  async function validateField(key: StepKey, value: string) {\n    setError(null);\n    try {\n      const schema = getFieldSchema(key);\n      if (!schema) return true;\n      schema.parse(value);\n      return true;\n    } catch (e: any) {\n      if (e?.issues && Array.isArray(e.issues)) {\n        setError(e.issues.map((i: any) => i.message).join(\" \"));\n      } else {\n        setError(e.message || \"Valeur invalide\");\n      }\n      return false;\n    }\n  }\n\n  async function onNext() {\n    const val = values[current.key];\n    const ok = await validateField(current.key, val);\n    if (!ok) return;\n    setStepIndex((s) => Math.min(s + 1, steps.length - 1));\n  }\n\n  function onBack() {\n    setError(null);\n    setStepIndex((s) => Math.max(0, s - 1));\n  }\n\n  function onChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const v = e.target.value;\n    setValues((prev) => ({ ...prev, [current.key]: v }));\n    setError(null);\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 p-6\">\n      <div className=\"w-full max-w-md bg-white rounded-2xl shadow-lg p-6\">\n        <h1 className=\"text-center text-2xl font-bold mb-4\">Se connecter</h1>\n\n        <form action={action} method=\"post\" className=\"space-y-6\">\n          {/* progress */}\n          <div className=\"flex items-center gap-2 justify-center\">\n            {steps.map((s, i) => (\n              <div\n                key={s.key}\n                className={`h-2 w-8 rounded ${\n                  i <= stepIndex ? \"bg-indigo-600\" : \"bg-gray-200\"\n                }`}\n              ></div>\n            ))}\n          </div>\n\n          {/* visible field */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              {current.label}\n            </label>\n            <input\n              autoFocus\n              name={current.key}\n              value={values[current.key]}\n              onChange={onChange}\n              type={current.type ?? \"text\"}\n              placeholder={current.placeholder}\n              className=\"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n            />\n            {error && <p className=\"text-red-600 text-sm mt-2\">{error}</p>}\n          </div>\n\n          {/* hidden fields so final submit contains everything */}\n          {Object.entries(values).map(([k, v]) => (\n            <input key={k} type=\"hidden\" name={k} value={v} />\n          ))}\n\n          <div className=\"flex justify-between\">\n            <button\n              type=\"button\"\n              onClick={onBack}\n              disabled={stepIndex === 0}\n              className=\"px-4 py-2 rounded-lg border disabled:opacity-50\"\n            >\n              Retour\n            </button>\n            {stepIndex < steps.length - 1 ? (\n              <button\n                type=\"button\"\n                onClick={onNext}\n                className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg\"\n              >\n                Suivant\n              </button>\n            ) : (\n              <button\n                type=\"submit\"\n                disabled={pending}\n                className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg\"\n              >\n                {pending ? \"Connexion...\" : \"Se connecter\"}\n              </button>\n            )}\n          </div>\n\n          {state?.message && <p className=\"text-green-600\">{state.message}</p>}\n          {state?.errors && (\n            <div className=\"text-red-600 text-sm\">\n              {Object.entries(state.errors).map(([k, v]) => (\n                <p key={k}>\n                  {k}: {Array.isArray(v) ? v.join(\", \") : v}\n                </p>\n              ))}\n            </div>\n          )}\n        </form>\n      </div>\n    </div>\n  );\n}\n","/* __next_internal_action_entry_do_not_use__ [{\"60c34110c9b4f198799d0d18a0210875e3b8c51fcf\":\"login\"},\"app/actions/auth.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var login=/*#__PURE__*/createServerReference(\"60c34110c9b4f198799d0d18a0210875e3b8c51fcf\",callServer,void 0,findSourceMapURL,\"login\");"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml","ReactServerDOMTurbopackClient","process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","ReactJsxRuntime","React"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6]}