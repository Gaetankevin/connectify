module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},72798,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(5050),f=(0,e.createServerReference)("603ee242f10ad53101bba517e4d3967a09d43df2bc",e.callServer,void 0,e.findSourceMapURL,"signup"),g=a.i(39081);let h=[{key:"name",label:"Nom",placeholder:"Quel est votre nom ?"},{key:"surname",label:"Prénom",placeholder:"Quel est votre prénom ?"},{key:"username",label:"Nom d'utilisateur",placeholder:"Choisissez un nom d'utilisateur"},{key:"email",label:"Email",type:"email",placeholder:"Votre adresse e-mail"},{key:"password",label:"Mot de passe",type:"password",placeholder:"Choisissez un mot de passe"},{key:"confirmPassword",label:"Confirmer le mot de passe",type:"password",placeholder:"Confirmez votre mot de passe"}];function i(){let[a,e,i]=(0,c.useActionState)(f,void 0),j=(0,d.useRouter)();(0,c.useEffect)(()=>{if(a&&a.redirectTo)try{let b=a.redirectTo;b&&j.push(b)}catch(a){}},[a,j]);let[k,l]=(0,c.useState)(0),[m,n]=(0,c.useState)({name:"",surname:"",username:"",email:"",password:"",confirmPassword:""}),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!1),u=h[k];async function v(a){try{let b=await fetch("/api/username/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a})}),c=await b.json();return c?.available===!0}catch(a){return!1}}async function w(a){try{let b=await fetch("/api/email/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})}),c=await b.json();return c?.available===!0}catch(a){return!1}}async function x(a,b){p(null);try{if("confirmPassword"===a){if(b!==m.password)throw Error("Les mots de passe ne correspondent pas");return!0}let c=g.SignupFormSchema.shape[a];if(!c)return!0;if(c.parse(b),"username"===a&&!await v(b))return p("Ce nom d'utilisateur est déjà pris"),!1;if("email"===a&&!await w(b))return p("Cette adresse e-mail est déjà utilisée"),!1;return!0}catch(a){return a?.issues&&Array.isArray(a.issues)?p(a.issues.map(a=>a.message).join(" ")):p(a.message||"Valeur invalide"),!1}}async function y(){let a=m[u.key];await x(u.key,a)&&l(a=>Math.min(a+1,h.length-1))}async function z(){if(m.name||m.surname){t(!0),r(null);try{let a=await fetch("/api/username/suggest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m.name,surname:m.surname})}),b=await a.json();r(Array.isArray(b.suggestions)?b.suggestions:[])}catch(a){r([])}finally{t(!1)}}}return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-lg p-6",children:[(0,b.jsx)("h1",{className:"text-center text-2xl font-bold mb-4",children:"Créer un compte"}),(0,b.jsxs)("form",{action:e,method:"post",className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-2 justify-center",children:h.map((a,c)=>(0,b.jsx)("div",{className:`h-2 w-8 rounded ${c<=k?"bg-indigo-600":"bg-gray-200"}`},a.key))}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:u.label}),(0,b.jsx)("input",{autoFocus:!0,name:u.key,value:m[u.key],onChange:function(a){let b=a.target.value;n(a=>({...a,[u.key]:b})),"username"===u.key&&(r(null),p(null))},type:u.type??"text",placeholder:u.placeholder,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),o&&(0,b.jsx)("p",{className:"text-red-600 text-sm mt-2",children:o}),"username"===u.key&&(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:z,disabled:s||!m.name&&!m.surname,className:"px-3 py-1 bg-gray-100 rounded-md text-sm border",children:s?"Génération...":"Suggérer des usernames"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"ou entrez le vôtre"})]}),q&&q.length>0&&(0,b.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:q.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{n(b=>({...b,username:a})),r(null),p(null)},className:"text-sm px-3 py-1 bg-indigo-50 border rounded-full hover:bg-indigo-100",children:a},a))})]})]}),Object.entries(m).map(([a,c])=>(0,b.jsx)("input",{type:"hidden",name:a,value:c},a)),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{type:"button",onClick:function(){p(null),l(a=>Math.max(0,a-1))},disabled:0===k,className:"px-4 py-2 rounded-lg border disabled:opacity-50",children:"Retour"}),k<h.length-1?(0,b.jsx)("button",{type:"button",onClick:y,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg",children:"Suivant"}):(0,b.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg",children:i?"Création...":"Créer le compte"})]}),a?.message&&(0,b.jsx)("p",{className:"text-green-600",children:a.message}),a?.errors&&(0,b.jsx)("div",{className:"text-red-600 text-sm",children:Object.entries(a.errors).map(([a,c])=>(0,b.jsxs)("p",{children:[a,": ",Array.isArray(c)?c.join(", "):c]},a))})]})]})})}a.s(["default",()=>i],72798)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__356f9e58._.js.map