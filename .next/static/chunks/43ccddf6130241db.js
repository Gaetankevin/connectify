(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12834,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),r=e.i(95187),n=(0,r.createServerReference)("603ee242f10ad53101bba517e4d3967a09d43df2bc",r.callServer,void 0,r.findSourceMapURL,"signup"),i=e.i(96410);let l=[{key:"name",label:"Nom",placeholder:"Quel est votre nom ?"},{key:"surname",label:"Prénom",placeholder:"Quel est votre prénom ?"},{key:"username",label:"Nom d'utilisateur",placeholder:"Choisissez un nom d'utilisateur"},{key:"email",label:"Email",type:"email",placeholder:"Votre adresse e-mail"},{key:"password",label:"Mot de passe",type:"password",placeholder:"Choisissez un mot de passe"},{key:"confirmPassword",label:"Confirmer le mot de passe",type:"password",placeholder:"Confirmez votre mot de passe"}];function o(){let[e,r,o]=(0,t.useActionState)(n,void 0),d=(0,a.useRouter)();(0,t.useEffect)(()=>{if(e&&e.redirectTo)try{let s=e.redirectTo;s&&d.push(s)}catch(e){}},[e,d]);let[c,u]=(0,t.useState)(0),[m,p]=(0,t.useState)({name:"",surname:"",username:"",email:"",password:"",confirmPassword:""}),[h,y]=(0,t.useState)(null),[x,g]=(0,t.useState)(null),[b,f]=(0,t.useState)(!1),j=l[c];async function v(e){try{let s=await fetch("/api/username/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})}),t=await s.json();return t?.available===!0}catch(e){return!1}}async function w(e){try{let s=await fetch("/api/email/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),t=await s.json();return t?.available===!0}catch(e){return!1}}async function N(e,s){y(null);try{if("confirmPassword"===e){if(s!==m.password)throw Error("Les mots de passe ne correspondent pas");return!0}let t=i.SignupFormSchema.shape[e];if(!t)return!0;if(t.parse(s),"username"===e&&!await v(s))return y("Ce nom d'utilisateur est déjà pris"),!1;if("email"===e&&!await w(s))return y("Cette adresse e-mail est déjà utilisée"),!1;return!0}catch(e){return e?.issues&&Array.isArray(e.issues)?y(e.issues.map(e=>e.message).join(" ")):y(e.message||"Valeur invalide"),!1}}async function k(){let e=m[j.key];await N(j.key,e)&&u(e=>Math.min(e+1,l.length-1))}async function S(){if(m.name||m.surname){f(!0),g(null);try{let e=await fetch("/api/username/suggest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m.name,surname:m.surname})}),s=await e.json();g(Array.isArray(s.suggestions)?s.suggestions:[])}catch(e){g([])}finally{f(!1)}}}return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6",children:(0,s.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-lg p-6",children:[(0,s.jsx)("h1",{className:"text-center text-2xl font-bold mb-4",children:"Créer un compte"}),(0,s.jsxs)("form",{action:r,method:"post",className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 justify-center",children:l.map((e,t)=>(0,s.jsx)("div",{className:`h-2 w-8 rounded ${t<=c?"bg-indigo-600":"bg-gray-200"}`},e.key))}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:j.label}),(0,s.jsx)("input",{autoFocus:!0,name:j.key,value:m[j.key],onChange:function(e){let s=e.target.value;p(e=>({...e,[j.key]:s})),"username"===j.key&&(g(null),y(null))},type:j.type??"text",placeholder:j.placeholder,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),h&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-2",children:h}),"username"===j.key&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:S,disabled:b||!m.name&&!m.surname,className:"px-3 py-1 bg-gray-100 rounded-md text-sm border",children:b?"Génération...":"Suggérer des usernames"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"ou entrez le vôtre"})]}),x&&x.length>0&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:x.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>{p(s=>({...s,username:e})),g(null),y(null)},className:"text-sm px-3 py-1 bg-indigo-50 border rounded-full hover:bg-indigo-100",children:e},e))})]})]}),Object.entries(m).map(([e,t])=>(0,s.jsx)("input",{type:"hidden",name:e,value:t},e)),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{type:"button",onClick:function(){y(null),u(e=>Math.max(0,e-1))},disabled:0===c,className:"px-4 py-2 rounded-lg border disabled:opacity-50",children:"Retour"}),c<l.length-1?(0,s.jsx)("button",{type:"button",onClick:k,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg",children:"Suivant"}):(0,s.jsx)("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg",children:o?"Création...":"Créer le compte"})]}),e?.message&&(0,s.jsx)("p",{className:"text-green-600",children:e.message}),e?.errors&&(0,s.jsx)("div",{className:"text-red-600 text-sm",children:Object.entries(e.errors).map(([e,t])=>(0,s.jsxs)("p",{children:[e,": ",Array.isArray(t)?t.join(", "):t]},e))})]})]})})}e.s(["default",()=>o],12834)}]);